<!DOCTYPE html>
<html>

	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Scoreboard</title>
		<link href="http://cdn.staticfile.org/emoji/0.2.2/emoji.css" rel="stylesheet" type="text/css" />
		<script src="http://cdn.staticfile.org/jquery/2.1.0/jquery.min.js"></script>
		<script src="http://cdn.staticfile.org/emoji/0.2.2/emoji.js"></script>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
		<link rel="stylesheet" href="/css/main.css">
		<link rel="icon" href="/favicon.ico" type="image/x-icon">
	</head>

	<body class="body-background">
		<div class="position-absolute background-color-0 h-100 w-50"></div>
		<div class="position-absolute background-color-1 h-100 w-50 top-0 end-0"></div>
		<div class="d-flex flex-row vh-100" id="scoreboard">
			{{cards}}
		</div>
		<script src="/socket.io/socket.io.js"></script>
		<script>
			const teams = [
				{ id: 'team1', name: 'Gurls' },
				{ id: 'team2', name: 'Bois' },
			];

			function generateCards(scores) {
				let cards = '';

				const teamScores = teams.map(team => ({ team: team.id, score: scores[team.id] }));

				teamScores.forEach((team, index) => {
					const card = `
						<div class="w-50 text-center" data-team="${team.team}" style="z-index: 2;">
							<div class="d-flex flex-column h-100">
								<div class="d-flex align-items-center justify-content-center h-50">
									<p class="mb-0 font-amador text-rotate${index}">${teams.find(t => t.id === team.team).name}</p>
								</div>
								<div class="d-flex justify-content-center mt-1 h-50">
									<p class="team-score score-text" id="${team.team}-score">${team.score}</p>
								</div>
							</div>
						</div>
					`;
					cards += card;
				});

				return cards;
			}

			function updateScores(scores) {
				const scoreboardContainer = document.getElementById('scoreboard');
				const cards = generateCards(scores);
				scoreboardContainer.innerHTML = cards;
			}

			function fetchScores() {
				fetch('/scores')
					.then(response => response.json())
					.then(scores => {
						updateScores(scores);
					})
					.catch(error => console.error('Error:', error));
			}

			const socket = io();
			socket.on('score-update', scores => {
				updateScores(scores);
			});

			window.onload = function () {
				fetchScores();
			};
		</script>
	</body>

</html>